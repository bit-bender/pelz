enclave
{
  from "sgx_tsgxssl.edl" import *;
  from "sgx_pthread.edl" import *;
  from "pelz_enclave.edl" import *;

  include "common_table.h"
  include "charbuf.h"
  include "test_defines.h"

  trusted
  {
    public TableResponseStatus test_table_lookup(TableType type,
                                                 charbuf id,
                                                 [out] size_t *index);
    
    public int test_aes_keywrap_3394nopad_encrypt(
      size_t key_len,
      [in, size=key_len] unsigned char *key,
      size_t inData_len,
      [in, size=inData_len] unsigned char *inData,
      [out] size_t *outData_len,
      [out] unsigned char **outData);

    public int test_aes_keywrap_3394nopad_decrypt(
      size_t key_len,
      [in, size=key_len] unsigned char *key,
      size_t inData_len,
      [in, size=inData_len] unsigned char *inData,
      [out] size_t *outData_len,
      [out] unsigned char **outData);

    public MsgTestStatus pelz_enclave_msg_test_helper(
      uint8_t msg_type,
      uint8_t req_type,
      charbuf cipher,
      charbuf key_id,
      charbuf msg_data,
      charbuf msg_status,
      charbuf der_sign_priv,
      charbuf der_verify_cert,
      charbuf der_encrypt_cert,
      charbuf der_decrypt_priv,
      MsgTestSelect test_select);

    public ReqTestStatus pelz_enclave_req_test_helper(
      charbuf cipher,
      charbuf key_id, 
      ReqTestSelect test_select);

    public ReqTestStatus pelz_enclave_service_test_helper(
      charbuf cipher,
      charbuf key_id,
      charbuf der_req_priv,
      charbuf der_req_cert,
      charbuf der_resp_priv,
      charbuf der_resp_cert);
  };
};

